<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Архитектура БД Oracle</title>

    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css">
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    <!-- Our style -->
    <link rel="stylesheet" type="text/css" href="/assets/css/styles.css">
	<link rel="stylesheet" type="text/css" href="/assets/css/avel.css">
</head>

  <body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light navbar-fixed-top">
  <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">Сайт Велигжанина Андрея</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse menu">
			<ul class="nav navbar-nav navbar-right">
                 
                    <li>
                       <a href="/index.html#about">Обо мне</a>
                    </li>
                 
                    <li>
                       <a href="/index.html#education">Образование</a>
                    </li>
                 
                    <li>
                       <a href="/index.html#work">Работа</a>
                    </li>
                 
                    <li>
                       <a href="/index.html#skills">Навыки</a>
                    </li>
                 
                    <li>
                       <a href="/index.html#portfolio">Портфолио</a>
                    </li>
                 
                    <li>
                       <a href="/index.html#hobby">Увлечения</a>
                    </li>
                 
                    <li>
                       <a href="/index.html#contact">Контакты</a>
                    </li>
                 
        	</ul>
        </div>
      </div>
  </div>
</nav>

    <section class="pfblock"><div class="container">  		<!-- Translations -->
	<div class="col-xs-6" align=left>
		<a href="/index.html">home</a> \ <a href="/pages/skills/oracle/concepts.html">Oracle. Database Concepts</a>
	</div>

	<div class="col-xs-6" align=right>
		Написано: 22.12.2022
	</div>

   	<div class="col-sm-12 my">
		<h1 id="архитектура-бд-oracle">Архитектура БД Oracle</h1>

<p><img src="/assets/images/oracle_architecture.jpg" alt="Architecture" /></p>

<p><strong>Сервер БД</strong> – это ключ к управлению информацией.</p>

<p>Как правило, <strong>сервер</strong> надёжно управляет большим объемом данных в многопользовательской среде, чтобы пользователи могли одновременно получать доступ к одним и тем же данным. Сервер БД также предотвращает несанкционированный доступ и предоставляет эффективные решения для восстановления после сбоя.</p>

<h2 id="бд-и-экземпляр">БД и экземпляр</h2>

<p>Сервер БД Oracle состоит из базы данных и, по крайней мере, одного <strong>экземпляра БД</strong>, обычно называемого просто <strong>экземпляром</strong>.</p>

<p>Поскольку экземпляр и БД настолько тесно связаны, термин БД Oracle иногда относится как к экземпляру, так и к БД. В самом строгом смысле эти термины имеют следующие значения:</p>

<ul>
  <li>БД</li>
</ul>

<p>База данных – это набор файлов, расположенных на диске, в которых хранятся пользовательские данные. Эти файлы данных могут существовать независимо от экземпляра базы данных. Начиная с Oracle Database 21c, “база данных” относится конкретно к файлам данных многопользовательской контейнерной базы данных (CDB), подключаемой базы данных (PDB) или контейнера приложений.</p>

<ul>
  <li>Экземпляр БД</li>
</ul>

<p>Экземпляр – это именованный набор структур памяти, которые управляют файлами базы данных. Экземпляр базы данных состоит из области общей памяти, называемой <strong>глобальной областью системы</strong> (SGA), и набора фоновых процессов. Экземпляр может существовать независимо от файлов базы данных.</p>

<h3 id="мультиконтейнерная-архитектура-multitenant-architecture">Мультиконтейнерная архитектура (Multitenant Architecture)</h3>

<p>Мультиконтейнерная архитектура позволяет базе данных Oracle быть контейнерной базой данных (<strong>CDB</strong>).</p>

<p>Каждая база данных Oracle должна содержать или быть способной содержаться в другой базе данных. Например, CDB содержит PDB-файлы, а контейнер приложения содержит PDB-файлы приложений. PDB содержится в CDB или контейнере приложения, а контейнер приложения содержится в CDB.</p>

<p>Начиная с Oracle Database 21c, единственной поддерживаемой архитектурой является мультиконтейнерная база данных. В предыдущих выпусках Oracle поддерживала неконтейнерные базы данных (non-CDBS).</p>

<h4 id="cdbs"><strong>CDBs</strong></h4>

<p>CDB содержит один или несколько созданных пользователем PDB и контейнеров приложений.</p>

<p>На физическом уровне cdb представляет собой набор файлов: файл управления, файлы журнала онлайн-повтора и файлы данных. Экземпляр базы данных управляет файлами, составляющими CDB.</p>

<p>На следующем рисунке показан CDB и связанный с ним экземпляр базы данных.</p>

<p><img src="/assets/images/oracon_fig1-1.jpg" alt="OraCon_Fig1-1" /></p>

<h4 id="pdbs"><strong>PDBs</strong></h4>

<p><strong>PDB</strong> – это переносимая коллекция схем, объектов схемы и несхемных объектов, которая отображается в приложении как отдельная база данных.</p>

<p>На физическом уровне каждая PDB имеет свой собственный набор файлов данных, в которых хранятся данные для PDB. CDB включает в себя все файлы данных для PDF-файлов, содержащихся в нем, и набор системных файлов данных, которые хранят метаданные для самого CDB.</p>

<p>Чтобы переместить или заархивировать PDB, вы можете отключить её. Отключенная PDB состоит из файлов данных PDB и файла метаданных. Отключенный PDB нельзя использовать до тех пор, пока он не будет подключен к CDB.</p>

<p>На следующем рисунке показан CDB с именем MYCDB.</p>

<p><img src="/assets/images/oracon_fig1-2.jpg" alt="OraCon_Fig1-2" /></p>

<p>Физически, MYCDB – это база данных Oracle, в смысле набора файлов данных, связанных с экземпляром. MYCDP имеет один экземпляр базы данных, хотя в кластерах реальных приложений Oracle возможно несколько экземпляров, и один набор файлов базы данных.</p>

<p>MYCDB содержит два PDB: hrpdb и salespdb. Как показано на рис. 1-2, эти PDB отображаются в соответствующих приложениях как отдельные, независимые базы данных. Приложение не знает, подключается ли оно к CDB или PDB.</p>

<p>Чтобы администрировать CDB или любую PDB внутри нее, можно подключиться к корневому каталогу CDB. Корень – это набор схем, объектов схемы и несхемных объектов, к которым принадлежат все PDB и контейнеры приложений.</p>

<h4 id="контейнеры-для-приложений"><strong>Контейнеры для приложений</strong></h4>

<p><strong>Контейнер приложения</strong> – это необязательный пользовательский контейнер в CDB, в котором хранятся данные и метаданные для одного или нескольких приложений.</p>

<p>В этом контексте, приложение (также называемое основным определением приложения) представляет собой именованный версионный набор общих данных и метаданных, хранящихся в корневом каталоге приложения. Например, приложение может включать определения таблиц, представлений, учетных записей пользователей и пакетов PL/SQL, которые являются общими для набора PDB.</p>

<p>В некотором смысле, контейнер приложения функционирует как CDB для конкретного приложения внутри CDB. Контейнер приложения, как и сам CDB, может включать в себя несколько PDB приложений и позволяет этим PDB обмениваться метаданными и данными. На физическом уровне, контейнер приложения имеет свой собственный набор файлов данных, точно так же, как PDB.</p>

<p>Например, при развертывании SaaS может использоваться несколько PDB приложений, каждый для отдельного клиента, которые совместно используют метаданные и данные приложения. Например, на следующем рисунке sales_app – это модель приложения в корневом каталоге приложения. База данных приложения с именем cust1_pdb содержит данные о продажах только для клиента 1, тогда как база данных приложения с именем cust2_pdb содержит данные о продажах только для клиента 2. Подключение, отсоединение, клонирование и другие операции на уровне PDB доступны для отдельных клиентских PDB.</p>

<p><img src="/assets/images/oracon_fig1-3.jpg" alt="OraCon_Fig1-3" /></p>

<h3 id="архитектура-из-кусочков-sharding-architecture">Архитектура из кусочков (Sharding Architecture)</h3>

<p>Oracle Sharding – это метод масштабирования базы данных, основанный на горизонтальном разделении данных на несколько PDB. Приложения воспринимают пул PDB как единую логическую БД.</p>

<p>Ключевые преимущества сегментирования для приложений OLTP включают линейную масштабируемость, локализацию сбоев и географическое распределение данных. Лоскуточность хорошо подходит для развертывания в облаке Oracle. В отличие от хранилищ данных NoSQL, которые реализуют сегментирование, Oracle Sharding предоставляет преимущества сегментирования без ущерба для возможностей корпоративной РСУБД.</p>

<p>В лоскуточной архитектуре каждый CDB размещается на выделенном сервере со своими собственными локальными ресурсами: процессором, памятью, флэш-памятью или диском. Вы можете назначить PDB в качестве фрагмента. Фрагменты PDB из разных CDB составляют единую логическую базу данных, которая называется разделенной базой данных. Два фрагмента в одном и том же CDB не могут быть членами одной и той же общей базы данных. Однако в пределах одного и того же CDB или PDB может находиться в одной разделенной базе данных, а другая PDB может находиться в отдельной разделенной базе данных.</p>

<p>Горизонтальное разделение предполагает разделение таблицы базы данных на шарды таким образом, чтобы каждый шард содержал таблицу с одинаковыми столбцами, но разным подмножеством строк. Таблица, разделенная таким образом, также известна как шардированная таблица. На следующем рисунке показана шардированная таблица, разделенная по горизонтали на три шарда, каждый из которых представляет собой PDB в отдельном CDB.</p>

<p><img src="/assets/images/oracon_fig1-4.jpg" alt="OraCon_Fig1-4" /></p>

<p>Примером использования является распределение данных учетной записи клиента по нескольким CDB. Например, клиент с идентификатором 28459361 может просмотреть свои записи. На следующем рисунке показана возможная архитектура. Запрос клиента направляется через пул подключений, где руководители шардов (сетевые прослушиватели) направляют запрос в соответствующий шард PDB, который содержит все строки клиента.</p>

<p><img src="/assets/images/oracon_fig1-5.jpg" alt="OraCon_Fig1-5" /></p>

<h2 id="структуры-хранения-бд">Структуры хранения БД</h2>

<p>Базу данных можно рассматривать как с физической, так и с логической точки зрения.</p>

<p>Физические данные – это данные, доступные для просмотра на уровне операционной системы. Например, утилиты операционной системы, такие как Linux ls и ps, могут отображать файлы и процессы базы данных. Логические данные, такие как таблица, имеют смысл только для базы данных. Инструкция SQL может перечислять таблицы в базе данных Oracle, но утилита операционной системы не может.</p>

<p>База данных имеет физические структуры и логические структуры. Поскольку физическая и логическая структуры разделены, вы можете управлять физическим хранилищем данных, не влияя на доступ к логическим структурам хранения. Например, переименование физического файла базы данных не приводит к переименованию таблиц, данные которых хранятся в этом файле.</p>

<h3 id="физические-структуры-хранения">Физические структуры хранения</h3>

<p>Физические структуры базы данных – это файлы, в которых хранятся данные.</p>

<p>Когда вы выполняете команду CREATE DATABASE, вы создаете CDB. Создаются следующие файлы:</p>

<ul>
  <li>Файлы данных</li>
</ul>

<p>Каждый CDB имеет один или несколько физических файлов данных, которые содержат все данные базы данных. Данные логических структур базы данных, таких как таблицы и индексы, физически хранятся в файлах данных.</p>

<ul>
  <li>Управляющие файлы</li>
</ul>

<p>У каждого CDB есть управляющий файл. Управляющий файл содержит метаданные, определяющие физическую структуру базы данных, включая имя базы данных, а также имена и расположения файлов базы данных.</p>

<ul>
  <li>Файлы онлайн-журналов redo</li>
</ul>

<p>Каждый CDB имеет онлайн-журнал redo, который представляет собой набор из двух или более онлайн-файлов журнала redo. Онлайн-журнал redo состоит из записей redo (также называемых записями журнала redo), в которые записываются все изменения, внесенные в данные.</p>

<p>Когда вы выполняете команду CREATE PLUGGABLE DATABASE в CDB, вы создаете PDB. PDB содержит выделенный набор файлов данных внутри CDB. PDB не имеет отдельного, выделенного файла управления и онлайн-журнала redo: эти файлы являются общими для PDB.</p>

<p>Многие другие файлы важны для функционирования CDB. К ним относятся файлы параметров и сетевые файлы. Файлы резервных копий и архивированные файлы журнала повтора – это автономные файлы, важные для резервного копирования и восстановления.</p>

<h3 id="логические-структуры-хранения">Логические структуры хранения</h3>

<p>Логические структуры хранения данных позволяют БД Oracle осуществлять детальный контроль за использованием дискового пространства.</p>

<p>В этом разделе обсуждаются логические структуры хранения:</p>

<ul>
  <li>Блоки данных</li>
</ul>

<p>На самом высоком уровне детализации данные БД Oracle хранятся в блоках данных. Один блок данных соответствует определенному количеству байт на диске.</p>

<ul>
  <li>Экстенты</li>
</ul>

<p>Экстент – это определенное количество логически смежных блоков данных, полученных за одно распределение и используемых для хранения определенного типа информации.</p>

<ul>
  <li>Сегменты</li>
</ul>

<p>Сегмент – это набор экстентов, выделенных для пользовательского объекта (например, таблицы или индекса), данных отмены или временных данных.</p>

<ul>
  <li>Табличные пространства</li>
</ul>

<p>БД разделена на логические единицы хранения, называемые табличными пространствами. <strong>Табличное пространство</strong> – это логический контейнер для сегментов. Каждое табличное пространство состоит по крайней мере из одного файла данных.</p>

<h2 id="структуры-экземпляров-бд">Структуры экземпляров БД</h2>

<p>БД Oracle использует структуры памяти и процессы для управления CDB и доступа к нему. Все структуры памяти существуют в основной памяти компьютеров, составляющих СУБД.</p>

<p>Когда приложения подключаются к CDB или PDB, они подключаются к экземпляру БД. Экземпляр обслуживает приложения, выделяя другие области памяти в дополнение к SGA и запуская другие процессы в дополнение к фоновым процессам.</p>

<h3 id="процессы-бд-oracle">Процессы БД Oracle</h3>

<p><strong>Процесс</strong> – это механизм в операционной системе, который может выполнять ряд шагов. Некоторые операционные системы используют термины <em>job</em>, <em>задача</em> или <em>поток</em>.</p>

<p>В этом разделе поток эквивалентен процессу. У экземпляра БД Oracle есть следующие типы процессов:</p>

<ul>
  <li>Клиентские процессы</li>
</ul>

<p>Эти процессы создаются и поддерживаются для запуска программного кода прикладной программы или инструмента Oracle. В большинстве сред есть отдельные компьютеры для клиентских процессов.</p>

<ul>
  <li>Фоновые процессы</li>
</ul>

<p>Эти процессы объединяют функции, которые в противном случае обрабатывались бы несколькими программами базы данных Oracle, запущенными для каждого клиентского процесса. Фоновые процессы асинхронно выполняют ввод-вывод и отслеживают другие процессы базы данных Oracle, чтобы обеспечить повышенный параллелизм для повышения производительности и надежности.</p>

<ul>
  <li>Серверные процессы</li>
</ul>

<p>Эти процессы взаимодействуют с клиентскими процессами и взаимодействуют с базой данных Oracle для выполнения запросов.</p>

<p>Процессы Oracle включают серверные процессы и фоновые процессы. В большинстве сред процессы Oracle и клиентские процессы выполняются на отдельных компьютерах.</p>

<h3 id="структуры-памяти-экземпляров">Структуры памяти экземпляров</h3>

<p>БД Oracle создает и использует структуры памяти для программного кода, данных, совместно используемых пользователями, и личных областей данных для каждого подключенного пользователя.</p>

<p>Следующие структуры памяти связаны с экземпляром базы данных:</p>

<ul>
  <li>Системная Глобальная Область (SGA)</li>
</ul>

<p><strong>SGA</strong> – это группа структур общей памяти, которые содержат данные и управляющую информацию для одного экземпляра БД. Примеры компонентов SGA включают буферный кэш базы данных и общие области SQL. SGA может содержать необязательное хранилище столбцов в памяти (IM column store), которое позволяет заполнять данные в памяти в столбчатом формате.</p>

<ul>
  <li>Програмная Глобальная Область (PGA)</li>
</ul>

<p><strong>PGA</strong> – это область памяти, которая содержит данные и управляющую информацию для сервера или фонового процесса. Доступ к PGA является эксклюзивным для данного процесса. Каждый серверный процесс и фоновый процесс имеют свой собственный PGA.</p>

<h2 id="архитектура-приложений-и-сетей">Архитектура приложений и сетей</h2>

<p>Чтобы в полной мере использовать преимущества данной компьютерной системы или сети, БД Oracle позволяет распределять обработку между сервером базы данных и клиентскими программами. Компьютер, на котором запущена РСУБД, выполняет функции сервера баз данных, в то время как компьютеры, на которых запущены приложения, обрабатывают интерпретацию и отображение данных.</p>

<h3 id="архитектура-приложений">Архитектура Приложений</h3>

<p>Архитектура приложения – это вычислительная среда, в которой приложение базы данных подключается к базе данных Oracle. Две наиболее распространенные архитектуры баз данных – клиент/сервер и многоуровневая.</p>

<p><strong>Клиент/серверная архитектура.</strong></p>

<p>В архитектуре клиент/сервер, клиентское приложение инициирует запрос на выполнение операции на сервере базы данных. Сервер запускает программное обеспечение Oracle Database и выполняет функции, необходимые для одновременного общего доступа к данным. Сервер получает и обрабатывает запросы, исходящие от клиентов.</p>

<p><strong>Многоуровневая архитектура.</strong></p>

<p>В <strong>многоуровневой архитектуре</strong> один или несколько серверов приложений выполняют части операции. <strong>Сервер приложений</strong> содержит большую часть логики приложения, предоставляет доступ к данным для клиента и выполняет некоторую обработку запросов. Таким образом, нагрузка на базу данных уменьшается. Сервер приложений может служить интерфейсом между клиентами и несколькими базами данных и обеспечивать дополнительный уровень безопасности.</p>

<p><strong>Сервис-ориентированная архитектура (SOA)</strong> – это многоуровневая архитектура, в которой функциональность приложения инкапсулирована в сервисы. SOA-сервисы обычно реализуются как веб-сервисы. Веб-службы доступны через HTTP и основаны на стандартах на основе XML, таких как язык описания веб-служб (WSDL) и SOAP. БД Oracle может выступать в качестве поставщика веб-услуг в традиционной многоуровневой среде или среде SOA.</p>

<p><strong>Простой доступ к документам Oracle (SODA)</strong> – это внедрение SOA, которое позволяет вам получать доступ к данным, хранящимся в базе данных. SODA предназначена для разработки приложений без схем без знания функций реляционных баз данных или таких языков, как SQL и PL /SQL. Вы можете создавать и хранить коллекции документов в базе данных Oracle, извлекать их и запрашивать без необходимости знать, как хранятся документы. SODA for REST использует архитектурный стиль representational state transfer (REST) для реализации SODA.</p>

<h3 id="архитектура-сетевых-служб-oracle">Архитектура Сетевых Служб Oracle</h3>

<p><strong>Сетевые Службы Oracle</strong> – это интерфейс между базой данных и сетевыми протоколами связи, которые облегчают распределенную обработку и распределенные базы данных.</p>

<p>Протоколы связи определяют способ передачи и приема данных по сети. Сетевые Службы Oracle поддерживает обмен данными по всем основным сетевым протоколам, включая TCP/IP, HTTP, FTP и WebDAV.</p>

<p><strong>Oracle Net</strong>, компонент Oracle Net Services, устанавливает и поддерживает сетевой сеанс от клиентского приложения к серверу базы данных. После установления сетевого сеанса Oracle Net действует как курьер данных как для клиентского приложения, так и для сервера базы данных, обмениваясь сообщениями между ними. Oracle Net может выполнять эти задания, поскольку он расположен на каждом компьютере в сети.</p>

<p>Важным компонентом сетевых служб является Oracle Net Listener (называемый слушателем), который представляет собой процесс, выполняемый в базе данных или в другом месте сети. Клиентские приложения отправляют запросы на подключение к прослушивателю, который управляет трафиком этих запросов к базе данных. Когда соединение установлено, клиент и база данных взаимодействуют напрямую.</p>

<p>Наиболее распространенными способами настройки базы данных Oracle для обслуживания клиентских запросов являются:</p>

<ul>
  <li>Архитектура выделенного сервера (Dedicated server architecture)</li>
</ul>

<p>Каждый клиентский процесс подключается к выделенному серверному процессу. Серверный процесс не используется никаким другим клиентом в течение всего сеанса клиента. Каждому новому сеансу назначается выделенный серверный процесс.</p>

<ul>
  <li>Архитектура общего сервера (Shared server architecture)</li>
</ul>

<p>База данных использует пул общих серверных процессов для нескольких сеансов. Клиентский процесс взаимодействует с диспетчером, который представляет собой процесс, позволяющий многим клиентам подключаться к одному и тому же экземпляру базы данных без необходимости в выделенном серверном процессе для каждого клиента.</p>

   	</div>
</div></section>

    <footer class="footer hexlet-footer py-5 mt-5 text-muted">
  <div class="container">
    <div class="row mt-1">
      <div class="col-12 text-center">
        <a href="https://aveligzhanin.github.io/">Велигжанин Андрей</a> — Программист-разработчик C++ и Oracle.
      </div>
    </div>
  </div>
</footer>

  </body>
</html>