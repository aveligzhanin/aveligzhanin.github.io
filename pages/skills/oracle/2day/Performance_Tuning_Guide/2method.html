<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Метод повышения производительности БД Oracle</title>

    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css">
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    <!-- Our style -->
    <link rel="stylesheet" type="text/css" href="/assets/css/styles.css">
	<link rel="stylesheet" type="text/css" href="/assets/css/avel.css">
</head>

  <body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light navbar-fixed-top">
  <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">Сайт Велигжанина Андрея</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse menu">
			<ul class="nav navbar-nav navbar-right">
                 
                    <li>
                       <a href="/index.html#about">Обо мне</a>
                    </li>
                 
                    <li>
                       <a href="/index.html#education">Образование</a>
                    </li>
                 
                    <li>
                       <a href="/index.html#work">Работа</a>
                    </li>
                 
                    <li>
                       <a href="/index.html#skills">Навыки</a>
                    </li>
                 
                    <li>
                       <a href="/index.html#portfolio">Портфолио</a>
                    </li>
                 
                    <li>
                       <a href="/index.html#hobby">Увлечения</a>
                    </li>
                 
                    <li>
                       <a href="/index.html#contact">Контакты</a>
                    </li>
                 
        	</ul>
        </div>
      </div>
  </div>
</nav>

    <section class="pfblock"><div class="container">  		<!-- Translations -->
	<div class="col-xs-6" align=left>
		<a href="/index.html">home</a> \ <a href="/pages/skills/oracle.html">Oracle</a>
	</div>

	<div class="col-xs-6" align=right>
		Написано: 03.01.2023
	</div>

   	<div class="col-sm-12 my">
		<h1 id="2-метод-повышения-производительности-бд-oracle">2. Метод повышения производительности БД Oracle</h1>

<p>Повышение производительности – это итеративный процесс. Устранение первого <strong>узкого места</strong> (точки, где конкуренция за ресурсы наиболее высока) может не привести к немедленному повышению производительности, поскольку может быть обнаружено другое узкое место, которое оказывает еще большее влияние на производительность системы. Точная диагностика проблемы с производительностью – это первый шаг к тому, чтобы ваши изменения повысили производительность.</p>

<p>Как правило, проблемы с производительностью возникают из-за недостаточной пропускной способности (объем работы, который может быть выполнен за указанное время), неприемлемого времени отклика пользователя или задания (время для завершения указанной рабочей нагрузки) или из-за того и другого. Проблема может быть локализована в определенных прикладных модулях или охватывать всю систему.</p>

<p>Прежде чем просматривать статистику БД или операционной системы, крайне важно получить обратную связь от пользователей системы и людей, ответственных за приложение. Эта обратная связь облегчает постановку целей в области производительности. Улучшенную производительность можно измерить с точки зрения бизнес-целей, а не системной статистики.</p>

<p>Метод производительности Oracle может применяться до тех пор, пока цели производительности не будут достигнуты или сочтены непрактичными. Поскольку этот процесс является итеративным, некоторые исследования могут оказать незначительное влияние на производительность системы. Требуется время и опыт, чтобы быстро точно определить критические узкие места. Автоматический монитор диагностики базы данных (ADDM) реализует метод производительности Oracle и анализирует статистику для обеспечения автоматической диагностики основных проблем с производительностью. Поскольку ADDM может значительно сократить время, необходимое для повышения производительности системы, именно этот метод используется в данном руководстве.</p>

<p>В этой главе обсуждается метод повышения производительности БД Oracle и содержатся следующие разделы:</p>

<ul>
  <li>
    <p><a href="#2_1">Сбор статистики БД с использованием автоматического хранилища рабочей нагрузки</a></p>
  </li>
  <li>
    <p><a href="#2_2">Использование метода производительности Oracle</a></p>
  </li>
  <li>
    <p><a href="#2_3">Распространенные проблемы с производительностью, обнаруживаемые в БД</a></p>
  </li>
</ul>

<h2 id="сбор-статистики-бд-с-использованием-автоматического-хранилища-рабочей-нагрузки"><a name="2_1"></a>Сбор статистики БД с использованием автоматического хранилища рабочей нагрузки</h2>

<p>Статистика базы данных предоставляет информацию о типе нагрузки на базу данных и внутренних и внешних ресурсах, используемых базой данных. Чтобы точно диагностировать проблемы с производительностью базы данных с помощью ADDM, должна быть доступна статистика.</p>

<p><strong>Накопительная статистика</strong> – это число (например такое, как количество считываний блока). БД Oracle генерирует множество типов накопительной статистики для системы, сеансов и отдельных инструкций SQL. БД Oracle Database также отслеживает накопительную статистику по сегментам и службам. Автоматическое хранилище рабочей нагрузки (AWR) автоматически собирает статистику БД путем сбора, обработки и поддержания статистики производительности для целей обнаружения проблем с БД и самонастройки.</p>

<p>По умолчанию, БД собирает статистику каждый час и создает моментальный снимок AWR, представляющий собой набор данных за определенное время, который используется для сравнения производительности. Значения дельты, зафиксированные моментальным снимком, представляют изменения для каждой статистики за период времени. Статистика, собранная AWR, запрашивается из памяти. Собранные данные могут быть отображены как в отчетах, так и в представлениях.</p>

<p>Следующие параметры инициализации актуальны для AWR:</p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">STATISTICS_LEVEL</code><br />Установка этого параметра в значение <code class="language-plaintext highlighter-rouge">TYPICAL</code> (по умолчанию) или <code class="language-plaintext highlighter-rouge">ALL</code> позволяет собирать статистику AWR. Установка <code class="language-plaintext highlighter-rouge">STATISTICS_LEVEL</code> в значение <code class="language-plaintext highlighter-rouge">BASIC</code> отключает многие функции БД, включая AWR, и не рекомендуется.</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">CONTROL_MANAGEMENT_PACK_ACCESS</code><br />Установка значения <code class="language-plaintext highlighter-rouge">DIAGNOSTIC+TUNING</code> (по умолчанию) или <code class="language-plaintext highlighter-rouge">DIAGNOSTIC</code> включает автоматический диагностический мониторинг БД. Установка <code class="language-plaintext highlighter-rouge">CONTROL_MANAGEMENT_PACK_ACCESS</code> в значение <code class="language-plaintext highlighter-rouge">NONE</code> отключает многие функции БД, в том числе ADDM, и настоятельно не рекомендуется.</p>
  </li>
</ul>

<p><strong>Смотрите также:</strong></p>

<ul>
  <li>
    <p><a href="https://docs.oracle.com/en/database/oracle/oracle-database/21/refrn/STATISTICS_LEVEL.html#GUID-16B23F95-8644-407A-A6C8-E85CADFA61FF">Oracle Database Reference</a> для получения дополнительной информации о параметре инициализации <code class="language-plaintext highlighter-rouge">STATISTICS_LEVEL</code></p>
  </li>
  <li>
    <p><a href="https://docs.oracle.com/en/database/oracle/oracle-database/21/refrn/CONTROL_MANAGEMENT_PACK_ACCESS.html#GUID-A5CA11BA-AE1F-4A2E-9C59-A98BA1F4E5C2">Oracle Database Reference</a> для получения дополнительной информации о параметре инициализации <code class="language-plaintext highlighter-rouge">CONTROL_MANAGEMENT_PACK_ACCESS</code></p>
  </li>
</ul>

<p>Статистические данные БД, собранные и обработанные AWR, включают:</p>

<ul>
  <li>
    <p><a href="#2_1_1">Time Model Statistics</a></p>
  </li>
  <li>
    <p><a href="#2_1_2">Wait Event Statistics</a></p>
  </li>
  <li>
    <p><a href="#2_1_3">Session and System Statistics</a></p>
  </li>
  <li>
    <p><a href="#2_1_4">Active Session History Statistics</a></p>
  </li>
  <li>
    <p><a href="#2_1_5">High-Load SQL Statistics</a></p>
  </li>
</ul>

<h3 id="time-model-statistics"><a name="2_1_1"></a>Time Model Statistics</h3>

<p>Статистика временной модели измеряет время, проведенное в БД, в зависимости от типа операции. Наиболее важной статистикой временной модели является время БД (DB time). Время БД представляет собой общее время, затраченное на вызовы БД активными сессиями, и является показателем общей рабочей нагрузки экземпляра. Как показано на рисунке 2-1, время работы БД составляет часть общего времени отклика пользователя приложения.</p>

<p><img src="/assets/images/fig2_1_dbtime.jpg" alt="Fig2-1" /></p>

<p><strong>Сессия</strong> – это логический объект в памяти экземпляра БД, который представляет состояние текущего входа пользователя в БД. Время работы БД рассчитывается путем суммирования процессорного времени и времени ожидания всех активных сессий (сессий, которые не простаивают). Для любого запроса БД процессорное время – это сумма времени, затраченного на обработку запроса, в то время как время ожидания – это сумма всех ожиданий различных ресурсов экземпляра БД. Время БД включает только время, затраченное на клиентские процессы, и не включает время, затраченное на фоновые процессы, такие как <code class="language-plaintext highlighter-rouge">PMON</code>.</p>

<p>Например, сессия пользователя может включать онлайн-транзакцию, совершенную в онлайн-магазине книг, состоящую из действий, показанных на рисунке 2-2.</p>

<p><img src="/assets/images/fig2_2_dbtime.jpg" alt="Fig2-2" /></p>

<ol>
  <li>
    <p>Query for novels by author<br />Пользователь выполняет поиск романов определенного автора. Это действие заставляет приложение выполнять запрос к базе данных для романов автора.</p>
  </li>
  <li>
    <p>Browse results of query<br />Пользователь просматривает возвращенный список романов автора и получает доступ к дополнительной информации, такой как отзывы пользователей и статус учёта. Это действие заставляет приложение выполнять дополнительные запросы к БД.</p>
  </li>
  <li>
    <p>Add item to cart<br />После просмотра подробной информации о романах, пользователь решает добавить один роман в корзину покупок. Это действие приводит к тому, что приложение выполняет вызов БД для обновления корзины покупок.</p>
  </li>
  <li>
    <p>Checkout<br />Пользователь завершает транзакцию через подтверждение, используя адрес и платежную информацию, ранее сохраненные на веб-сайте книготорговца после предыдущей покупки. Это действие заставляет приложение выполнять различные операции с БД для извлечения информации пользователя, добавления нового заказа, обновления статуса и генерации подтверждения по электронной почте.</p>
  </li>
</ol>

<p>Для каждого из предыдущих действий пользователь делает запрос к БД, как показано стрелкой вниз на рисунке 2-2. Время процессора, затраченное БД на обработку запроса, и время ожидания, затраченное на ожидание БД, считаются временем БД, как показано заштрихованными областями. После завершения запроса результаты возвращаются пользователю, как показано стрелкой вверх. Пробел между стрелками вверх и вниз представляет общее время отклика пользователя на обработку запроса, которое содержит другие компоненты, помимо времени БД, как показано на рисунке 2-1.</p>

<blockquote>
  <p><strong>Обратите внимание</strong>: Время в БД измеряется накопительно с момента запуска экземпляра. Поскольку время БД объединяет время всех непростаивающих пользовательских сессий, время БД может превышать время, прошедшее с момента запуска экземпляра. Например, экземпляр, который проработал 5 минут, может иметь четыре активных сеанса, совокупное время работы с БД которых составляет 20 минут.</p>
</blockquote>

<p>Целью настройки БД является сокращение времени работы с БД. Таким образом, вы можете улучшить общее время отклика пользовательских транзакций в приложении.</p>

<h3 id="wait-event-statistics"><a name="2_1_2"></a>Wait Event Statistics</h3>

<p>События ожидания возрастают за сессию и показывают, что сессия ожидала завершения события, прежде чем смогла продолжить обработку. Когда сессии приходится ждать во время обработки пользовательского запроса, БД записывает ожидание, используя одно из набора предопределенных событий ожидания. Затем события группируются в классы ожидания, такие как пользовательский ввод-вывод и сетевой. Данные о событии ожидания выявляют симптомы проблем, которые могут влиять на производительность, таких как задержка, буфер или конфликт ввода-вывода.</p>

<p><strong>Смотрите также:</strong></p>

<ul>
  <li>
    <p><a href="https://docs.oracle.com/en/database/oracle/oracle-database/21/tgdba/measuring-database-performance.html#GUID-FC0E9098-1B1D-4532-A6C0-91E5A2FF8FB9">Oracle Database Performance Tuning Guide</a></p>
  </li>
  <li>
    <p><a href="https://docs.oracle.com/en/database/oracle/oracle-database/21/refrn/oracle-wait-events.html#GUID-03BFEEFB-1020-4F3F-8CF8-A23E7026684B">Oracle Database Reference</a></p>
  </li>
</ul>

<h3 id="session-and-system-statistics"><a name="2_1_3"></a>Session and System Statistics</h3>

<p>Большое количество накопленной статистики БД доступно на системном и сессионном уровне. Некоторые из этих статистических данных собраны AWR.</p>

<h3 id="active-session-history-statistics"><a name="2_1_4"></a>Active Session History Statistics</h3>

<p>Статистика истории активных сессий (ASH) представляет собой образцы активности сессии в БД. БД опрашивает активные сессии каждую секунду и сохраняет их в циклическом буфере в глобальной области системы (SGA). Любая сессия, подключенная к БД и использующая процессор, или ожидающая события, которое не относится к классу ожидания в режиме ожидания, считается активной. Фиксируя только активные сессии, можно получить управляемый набор данных. Размер данных напрямую связан с выполняемой работой, а не с количеством сессий, разрешенных для БД.</p>

<p>Используя пример времени DB, описанный в “Time Model Statistics”, образцы активности сессии собираются из онлайн-транзакции, совершенной на веб-сайте книготорговца, представленными вертикальными линиями под горизонтальной стрелкой на рисунке 2-3.</p>

<p><img src="/assets/images/fig2_3_ash.jpg" alt="Fig2-3" /></p>

<p>Светлые вертикальные линии представляют образцы неактивной активности сессии, которые не учитываются в статистике ASH. Жирные вертикальные линии представляют образцы активных сессий, которые записаны в:</p>

<ul>
  <li>
    <p>7:38, когда произошёл запрос романов автора</p>
  </li>
  <li>
    <p>7:42, когда пользователь просматривал результат запроса</p>
  </li>
  <li>
    <p>7:50, когда в корзину был добавлен один роман</p>
  </li>
  <li>
    <p>7:52, во время совершения заказа</p>
  </li>
</ul>

<table class="mbtablestyle1">
  <thead>
    <tr>
      <th>Time</th>
      <th>SID</th>
      <th>Module</th>
      <th>SQL ID</th>
      <th>State</th>
      <th>Event</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>7:38</td>
      <td>213</td>
      <td>Book by author</td>
      <td>qa324jffritcf</td>
      <td>Waiting</td>
      <td>db file sequential read</td>
    </tr>
    <tr>
      <td>7:42</td>
      <td>213</td>
      <td>Get review ID</td>
      <td>aferv5desfzs5</td>
      <td>CPU</td>
      <td>n/a</td>
    </tr>
    <tr>
      <td>7:50</td>
      <td>213</td>
      <td>Add item to cart</td>
      <td>hk32pekfcbdfr</td>
      <td>Waiting</td>
      <td>buffer busy wait</td>
    </tr>
    <tr>
      <td>7:52</td>
      <td>213</td>
      <td>Checkout</td>
      <td>abngldf95f4de</td>
      <td>Waiting</td>
      <td>log file sync</td>
    </tr>
  </tbody>
</table>

<h3 id="high-load-sql-statistics"><a name="2_1_5"></a>High-Load SQL Statistics</h3>

<p>Операторы SQL, которые потребляют наибольшее количество ресурсов, создают наибольшую нагрузку на систему, основанную на таких критериях, как затраченное время и время процессора.</p>

<h2 id="использование-метода-производительности-oracle"><a name="2_2"></a>Использование метода производительности Oracle</h2>

<p>Настройка производительности с использованием метода Oracle performance осуществляется путем выявления и устранения узких мест в базе данных, а также путем разработки эффективных инструкций SQL. Настройка базы данных выполняется в два этапа: проактивно и реактивно.</p>

<p>На этапе проактивной (предварительной) настройки, нужно выполнять задачи настройки как часть ежедневной процедуры обслуживания БД, такие как просмотр анализа ADDM и результатов, мониторинг производительности БД в режиме реального времени и реагировать на предупреждения.</p>

<p>На этапе реактивной (реагирующей) настройки, нужно реагировать на проблемы, о которых сообщают пользователи, такие как проблемы с производительностью, которые могут возникать в течение короткого периода времени, или снижение производительности БД в течение определенного периода времени.</p>

<p>Настройка SQL – это итеративный процесс для идентификации, настройки и повышения эффективности высоконагруженных SQL-инструкций.</p>

<p>Применение метода производительности Oracle включает в себя следующее:</p>

<ul>
  <li>
    <p>Выполнение предварительной подготовки, как описано в разделе “<a href="#2_2_1">Подготовка БД к настройке</a>”</p>
  </li>
  <li>
    <p>Регулярная предварительная настройка БД, как описано в разделе “<a href="#2_2_2">Предварительная настройка БД</a>”</p>
  </li>
  <li>
    <p>Идентификация, настройка и оптимизация высоко-нагруженных SQL-инструкций, как описано в разделе “<a href="#2_2_4">Настройка SQL-инструкций</a>”</p>
  </li>
</ul>

<p>Чтобы повысить производительность БД, нужно применять эти принципы итеративно.</p>

<h3 id="подготовка-бд-к-настройке"><a name="2_2_1"></a>Подготовка БД к настройке</h3>

<p>В этом разделе перечислены и описаны шаги, которые необходимо выполнить, прежде чем можно будет правильно настроить БД.</p>

<p><strong>Для подготовки базы данных к настройке:</strong></p>

<ol>
  <li>
    <p>Получайте отзывы от пользователей.<br />Определите масштаб проекта по повышению производительности и последующие цели по повышению производительности, а также определите цели по повышению производительности на будущее. Этот процесс является ключевым для планирования будущих мощностей.</p>
  </li>
  <li>
    <p>Проверьте операционные системы всех систем, связанных с производительностью пользователя.<br />Проверьте, полностью ли используются ресурсы оборудования или операционной системы. Перечислите все чрезмерно используемые ресурсы для возможного последующего анализа. Кроме того, убедитесь, что все оборудование функционирует должным образом.</p>
  </li>
  <li>
    <p>Убедитесь, что для параметра инициализации <code class="language-plaintext highlighter-rouge">STATISTICS_LEVEL</code> установлено значение <code class="language-plaintext highlighter-rouge">TYPICAL</code> (по умолчанию) или <code class="language-plaintext highlighter-rouge">ALL</code>, чтобы включить функции автоматической настройки производительности Oracle Database, включая AWR и ADDM.</p>
  </li>
  <li>
    <p>Убедитесь, что для параметра инициализации <code class="language-plaintext highlighter-rouge">CONTROL_MANAGEMENT_PACK_ACCESS</code> установлено значение <code class="language-plaintext highlighter-rouge">DIAGNOSTIC+TUNING</code> (по умолчанию) или <code class="language-plaintext highlighter-rouge">DIAGNOSTIC</code> для включения ADDM.</p>
  </li>
</ol>

<h3 id="предварительная-настройка-бд"><a name="2_2_2"></a>Предварительная настройка БД</h3>

<p>В этом разделе перечислены и описаны упреждающие шаги, необходимые для поддержания правильной настройки БД на регулярной основе. Выполните эти действия в рамках ежедневного обслуживания БД Oracle. Повторяйте процесс настройки до тех пор, пока ваши цели по производительности не будут достигнуты или не станут невозможными из-за других ограничений.</p>

<p><strong>Для предварительной настройки БД:</strong></p>

<ol>
  <li>
    <p>Просматривайте результаты ADDM, как описано в разделе Автоматический мониторинг производительности базы данных.<br />ADDM автоматически обнаруживает проблемы с производительностью базы данных и сообщает о них, включая большинство “<a href="(#2_3)">распространенных проблем с производительностью, обнаруженных в БД</a>”. Результаты отображаются в виде результатов ADDM на домашней странице базы данных в Oracle Enterprise Manager Cloud Control (Облачный контроль). Анализ этих результатов позволяет вам быстро выявить проблемы с производительностью, требующие вашего внимания.</p>
  </li>
  <li>
    <p>Выполните рекомендации ADDM, как описано в разделе Автоматический мониторинг производительности базы данных.<br />При каждом обнаружении ADDM ADDM автоматически предоставляет список рекомендаций по снижению влияния проблемы с производительностью. При выполнении рекомендации применяются предложенные изменения для повышения производительности базы данных.</p>
  </li>
  <li>
    <p>Отслеживайте проблемы с производительностью БД в режиме реального времени, как описано в разделе Мониторинг производительности базы данных в режиме реального времени.<br />Страница производительности в Cloud Control позволяет выявлять проблемы с производительностью в режиме реального времени и реагировать на них. Переходя к соответствующим страницам, вы можете выявлять и устранять проблемы с производительностью базы данных в режиме реального времени, не дожидаясь следующего анализа ADDM.</p>
  </li>
  <li>
    <p>Реагируйте на предупреждения, связанные с производительностью, как описано в разделе Мониторинг предупреждений о производительности.<br />На домашней странице базы данных в Cloud Control отображаются предупреждения, связанные с производительностью, генерируемые базой данных. Как правило, устранение проблем, указанных в этих предупреждениях, повышает производительность БД.</p>
  </li>
  <li>
    <p>Убедитесь, что любые изменения привели к желаемому эффекту, и убедитесь, что пользователи испытывают улучшения производительности.</p>
  </li>
</ol>

<h3 id="реагирующая-настройка-бд"><a name="2_2_3"></a>Реагирующая настройка БД</h3>

<p>В этом разделе перечислены и описаны шаги, необходимые для настройки БД на основе отзывов пользователей. Эта процедура настройки считается реактивной (реагирующей). Периодически выполняйте эту процедуру, когда пользователи сообщают о проблемах с производительностью.</p>

<p><strong>Для реактивной настройки БД:</strong></p>

<ol>
  <li>
    <p>Запустите ADDM вручную для диагностики текущей и исторической производительности БД, когда пользователи сообщают о проблемах с производительностью, как описано в разделе Мониторинг производительности БД вручную.<br />Таким образом, вы можете проанализировать текущую производительность БД перед следующим анализом ADDM или проанализировать историческую производительность БД, когда вы не осуществляли упреждающий мониторинг системы.</p>
  </li>
  <li>
    <p>Устраните временные проблемы с производительностью, как описано в разделе Устранение временных проблем с производительностью.<br />Отчеты об истории активных сеансов (ASH) позволяют анализировать временные проблемы с производительностью БД, которые являются кратковременными и не отображаются в анализе ADDM.</p>
  </li>
  <li>
    <p>Устраните снижение производительности с течением времени, как описано в разделе Устранение снижения производительности с течением времени.<br />Отчет о сравнении периодов автоматического хранилища рабочей нагрузки (AWR) позволяет сравнить производительность БД за два периода времени и устранить снижение производительности, которое может произойти от одного периода времени к другому.</p>
  </li>
  <li>
    <p>Убедитесь, что внесенные изменения произвели желаемый эффект, и убедитесь, что пользователи почувствовали улучшение производительности.</p>
  </li>
  <li>
    <p>Повторяйте эти шаги до тех пор, пока ваши цели по производительности не будут достигнуты или не станут невозможными из-за других ограничений.</p>
  </li>
</ol>

<h3 id="настройка-sql-инструкций"><a name="2_2_4"></a>Настройка SQL-инструкций</h3>

<p>В этом разделе перечислены и описаны шаги, необходимые для идентификации, настройки и оптимизации высоконагруженных инструкций SQL.</p>

<p><strong>Для настройки SQL-инструкций:</strong></p>

<ol>
  <li>
    <p>Определите высоконагруженные инструкции SQL, как описано в разделе Определение высоконагруженных инструкций SQL.<br />Используйте результаты ADDM и раздел Top SQL, чтобы определить высоконагруженные инструкции SQL, которые вызывают наибольшие разногласия.</p>
  </li>
  <li>
    <p>Настройте высоконагруженные SQL-инструкции, как описано в разделе Настройка SQL-инструкций.<br />Вы можете повысить эффективность высоконагруженных SQL-инструкций, настроив их с помощью SQL Tuning Advisor.</p>
  </li>
  <li>
    <p>Оптимизируйте пути доступа к данным, как описано в разделе Оптимизация путей доступа к данным.<br />Вы можете оптимизировать производительность путей доступа к данным, создав соответствующий набор материализованных представлений, журналов материализованных представлений и индексов для заданной рабочей нагрузки с помощью SQL Access Advisor.</p>
  </li>
  <li>
    <p>Проанализируйте влияние настройки SQL и других системных изменений на производительность SQL с помощью SQL Performance Analyzer.<br />Чтобы узнать, как использовать SQL Performance Analyzer, см. Руководство по тестированию БД Oracle.</p>
  </li>
  <li>
    <p>Повторяйте эти шаги до тех пор, пока все высоконагруженные SQL-инструкции не будут настроены на максимальную эффективность.</p>
  </li>
</ol>

<h2 id="распространенные-проблемы-с-производительностью-обнаруживаемые-в-бд"><a name="2_3"></a>Распространенные проблемы с производительностью, обнаруживаемые в БД</h2>

<p>В этом разделе перечислены и описаны распространенные проблемы с производительностью, обнаруживаемые в БД. Следуя методу производительности Oracle, вы сможете избежать этих проблем в экземпляре БД Oracle. Если у вас возникли эти проблемы, повторите действия в методе производительности Oracle, как описано в разделе “Использование метода производительности Oracle”, или обратитесь к соответствующему разделу, в котором рассматриваются эти проблемы:</p>

<ul>
  <li>
    <p>Узкие места процессора<br />Приложение работает плохо из-за того, что система привязана к процессору? Проблемы с производительностью, вызванные узкими местами процессора, диагностируются ADDM, как описано в разделе Автоматический мониторинг производительности БД. Вы также можете определить узкие места процессора, используя страницу производительности в Cloud Control, как описано в разделе “Мониторинг загрузки процессора”.</p>
  </li>
  <li>
    <p>Недостаточные структуры памяти<br />Достаточны ли размеры структур памяти Oracle, таких как Глобальная область системы (SGA), глобальная область программы (PGA) и буферный кэш? Проблемы с производительностью, вызванные недостаточными размерами структур памяти, диагностируются ADDM, как описано в разделе Автоматический мониторинг производительности БД. Вы также можете определить проблемы с использованием памяти, используя страницу производительности в Cloud Control, как описано в разделе “Мониторинг использования памяти”.</p>
  </li>
  <li>
    <p>Проблемы с пропускной способностью ввода-вывода<br />Работает ли подсистема ввода-вывода так, как ожидалось? Проблемы с производительностью, вызванные проблемами с пропускной способностью ввода-вывода, диагностируются ADDM, как описано в разделе Автоматический мониторинг производительности БД. Вы также можете определить проблемы с дисковым вводом-выводом, используя страницу производительности в Cloud Control, как описано в разделе “Мониторинг использования дискового ввода-вывода”.</p>
  </li>
  <li>
    <p>Неоптимальное использование приложением БД Oracle<br />Оптимально ли использует приложение БД Oracle? Такие проблемы, как многократное установление новых подключений к БД, чрезмерный синтаксический анализ SQL и высокий уровень конкуренции за небольшой объем данных (также известный как конкуренция блоков на уровне приложения), могут значительно снизить производительность приложения. Проблемы с производительностью, вызванные неоптимальным использованием приложением БД Oracle, диагностируются ADDM, как описано в разделе Автоматический мониторинг производительности БД. Вы также можете отслеживать активность пользователей в различных измерениях, включая SQL, сеанс, службы, модули и действия, используя страницу производительности в Cloud Control, как описано в разделе “Мониторинг активности пользователей”.</p>
  </li>
  <li>
    <p>Проблемы параллелизма<br />Оптимально ли работает БД из-за высокой степени параллельных действий в БД? Высокая степень одновременности действий может привести к конкуренции за общие ресурсы, которая может проявляться в виде блокировок или ожидания буферного кэша. Проблемы с производительностью, вызванные проблемами параллелизма, диагностируются ADDM, как описано в разделе Автоматический мониторинг производительности БД. Вы также можете выявить проблемы с параллелизмом, используя сеансы Top в Cloud Control, как описано в разделе “Мониторинг сеансов Top”.</p>
  </li>
  <li>
    <p>Проблемы с конфигурацией БД<br />Оптимально ли настроена БД для обеспечения желаемых уровней производительности? Например, есть ли признаки неправильного размера файлов журналов, проблем с архивированием, слишком большого количества контрольных точек или неоптимальных настроек параметров? Проблемы с производительностью, вызванные проблемами конфигурации БД, диагностируются ADDM, как описано в разделе Автоматический мониторинг производительности БД.</p>
  </li>
  <li>
    <p>Кратковременные проблемы с производительностью<br />Жалуются ли пользователи на кратковременные или прерывистые проблемы с производительностью? В зависимости от интервала между моментальными снимками, сделанными AWR, проблемы с производительностью, которые имеют короткую продолжительность, могут не быть зафиксированы ADDM. Вы можете определить кратковременные проблемы с производительностью, используя отчет об истории активных сеансов, как описано в разделе Устранение временных проблем с производительностью.</p>
  </li>
  <li>
    <p>Снижение производительности БД с течением времени<br />Есть ли доказательства того, что производительность БД со временем снизилась? Например, замечаете ли вы или ваши пользователи, что БД работает не так хорошо, как это было 6 месяцев назад? Вы можете сгенерировать отчет AWR Compare Periods, чтобы сравнить период, когда производительность была низкой, с периодом, когда производительность стабильна, чтобы определить параметры конфигурации, профиль рабочей нагрузки и статистику, которые отличаются между этими двумя периодами времени. Этот метод поможет вам определить причину снижения производительности, как описано в разделе Устранение снижения производительности с течением времени.</p>
  </li>
  <li>
    <p>Неэффективные или высоконагруженные SQL-инструкции<br />Используют ли какие-либо инструкции SQL чрезмерные системные ресурсы, которые влияют на систему? Проблемы с производительностью, вызванные высоконагруженными SQL-инструкциями, диагностируются ADDM, как описано в разделе Автоматический мониторинг производительности БД и “Идентификация высоконагруженных SQL-инструкций с использованием результатов ADDM”. Вы также можете идентифицировать высоконагруженные SQL-инструкции с помощью Top SQL в Cloud Control, как описано в разделе “Идентификация высоконагруженных SQL-инструкций с помощью Top SQL”. После того, как они будут идентифицированы, вы можете настроить высоконагруженные SQL-инструкции с помощью SQL Tuning Advisor, как описано в разделе Настройка SQL-инструкций.</p>
  </li>
  <li>
    <p>Конфликт объектов<br />Являются ли какие-либо объекты БД источником узких мест из-за постоянного доступа к ним? Проблемы с производительностью, вызванные конфликтом объектов, диагностируются ADDM, как описано в разделе Автоматический мониторинг производительности БД. Вы также можете оптимизировать путь доступа к данным к этим объектам с помощью SQL Access Advisor, как описано в разделе Оптимизация путей доступа к данным.</p>
  </li>
  <li>
    <p>Неожиданный регресс производительности после настройки SQL-инструкций<br />Ухудшается ли производительность SQL-инструкций после того, как они были настроены? Настройка инструкций SQL может привести к изменениям в планах их выполнения, что окажет значительное влияние на производительность SQL. В некоторых случаях изменения могут привести к улучшению производительности SQL. В других случаях изменения могут привести к регрессу SQL-инструкций, что приведет к снижению производительности SQL.</p>
  </li>
</ul>

<p>Прежде чем вносить изменения в производственную систему, вы можете проанализировать влияние настройки SQL на тестовую систему с помощью SQL Performance Analyzer. Эта функция позволяет прогнозировать влияние системных изменений на рабочую нагрузку SQL с помощью:</p>

<ul>
  <li>
    <p>Измерение производительности до и после изменения</p>
  </li>
  <li>
    <p>Создание отчета, описывающего изменение производительности</p>
  </li>
  <li>
    <p>Определение инструкций SQL, которые регрессировали или улучшились</p>
  </li>
  <li>
    <p>Предоставление рекомендаций по настройке для каждого оператора SQL, который регрессировал</p>
  </li>
  <li>
    <p>Позволяют вам выполнять рекомендации по настройке, когда это необходимо</p>
  </li>
</ul>

<p><br /><br /><br /><br /><br /><br /><br /></p>
<div class="row">
  <div class="col"><div align="left"><a href="/pages/skills/oracle/2day/Performance_Tuning_Guide/1introduction.html">&#8592; 1. Введение</a></div>
  </div>
<!--  <div class="col"><div align=right><a href="/pages/skills/oracle/sql_tuning_guide/2methodology.html">2. Методология производительности SQL &#8594;</a></div> 
 </div> -->
</div>

   	</div>
</div></section>

    <footer class="footer hexlet-footer py-5 mt-5 text-muted">
  <div class="container">
    <div class="row mt-1">
      <div class="col-12 text-center">
        <a href="https://aveligzhanin.github.io/">Велигжанин Андрей</a> — Программист-разработчик C++ и Oracle.
      </div>
    </div>
  </div>
</footer>

  </body>
</html>